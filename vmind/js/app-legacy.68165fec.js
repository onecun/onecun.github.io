(function(t){function e(e){for(var o,s,c=e[0],r=e[1],l=e[2],u=0,f=[];u<c.length;u++)s=c[u],i[s]&&f.push(i[s][0]),i[s]=0;for(o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o]);d&&d(e);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],o=!0,c=1;c<n.length;c++){var r=n[c];0!==i[r]&&(o=!1)}o&&(a.splice(e--,1),t=s(s.s=n[0]))}return t}var o={},i={app:0},a=[];function s(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=o,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)s.d(n,o,function(e){return t[e]}.bind(null,o));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],r=c.push.bind(c);c.push=e,c=c.slice();for(var l=0;l<c.length;l++)e(c[l]);var d=r;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},4244:function(t,e,n){},"43b7":function(t,e,n){"use strict";var o=n("4244"),i=n.n(o);i.a},"507a":function(t,e,n){},5290:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var o=n("8bbf"),i=n.n(o),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("nav-bar"),n("mind-map")],1)},s=[],c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{ref:"main",attrs:{id:"jsmind_container"}},[n("popup")],1)},r=[],l=(n("6e2c"),n("6376")),d=n.n(l),u=(n("4100"),n("9494"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],ref:"popup",staticClass:"popup-menu",style:{top:t.offsetTop,left:t.offsetLeft},on:{click:function(e){t.show=!1}}},[n("button",{staticClass:"add-node",on:{click:function(e){return t.addNode()}}},[n("span",{staticClass:"icon icon-node"}),n("span",[t._v("添加子节点")])]),n("button",{staticClass:"add-brother-node",on:{click:function(e){return t.addBrotherNode()}}},[n("span",{staticClass:"icon icon-sub-node"}),n("span",[t._v("添加兄弟节点")])]),n("button",{staticClass:"delete-node",on:{click:function(e){return t.deleteNode()}}},[n("span",{staticClass:"icon icon-delete"}),n("span",[t._v("删除")])]),n("button",{staticClass:"edit-node",on:{click:function(e){return t.editNode()}}},[n("span",{staticClass:"icon icon-edit"}),n("span",[t._v("编辑")])]),n("button",{staticClass:"toggle-node-tree",on:{click:function(e){return t.toggleNode()}}},[n("span",{staticClass:"icon icon-unfold"}),n("span",[t._v("显隐子节点")])])])}),f=[],m={data:function(){return{show:!1,offsetTop:"",offsetLeft:""}},methods:{addNode:function(){this.$bus.$emit("addNode")},addBrotherNode:function(){this.$bus.$emit("addBrotherNode")},deleteNode:function(){this.$bus.$emit("deleteNode")},editNode:function(){this.$bus.$emit("editNode")},toggleNode:function(){this.$bus.$emit("toggleNode")},setPopupPosition:function(t){var e=t.target;if("JMNODE"===e.tagName){this.show=!0;var n=e.offsetTop,o=e.offsetLeft;this.offsetTop=n-60+"px",this.offsetLeft=o+"px",e.scrollIntoView({block:"center",behavior:"smooth",inline:"center"})}else"BUTTON"!==e.tagName&&"SPAN"!==e.tagName&&(this.show=!1)}},mounted:function(){var t=this;window.addEventListener("mousedown",function(e){t.setPopupPosition(e)}),this.$bus.$on("popup-hide",function(){t.show=!1})}},h=m,p=(n("7899"),n("2877")),v=Object(p["a"])(h,u,f,!1,null,null,null),g=v.exports,b={clearLocal:function(){localStorage.clear()},getLocal:function(){var t=localStorage.getItem("vmind");return t?JSON.parse(t):t},saveLocal:function(t){this.clearLocal(),localStorage.setItem("vmind",JSON.stringify(t))}},w=(n("ac6a"),n("14b9"),function(t){return JSON.stringify(t)}),_=function t(e){var n={data:{}};return n.data.id=e.id,n.data.text=e.topic,n.data.created=Date.now(),n.data.expandState=e.expanded?"expand":"collapse",e.children&&(n.data.children=e.children.map(function(e){return t(e)})),n},k=function(t){var e={root:_(t.data)};return JSON.stringify(e)},C=function(t,e){return e<=6?"#".repeat(e)+" "+t.topic:"\t".repeat(e-6)+"- "+t.topic},x=function(t,e){return"\t".repeat(e)+t.topic},$=function(t,e){var n=[],o=function t(o,i){var a;o&&(a="md"===e?C(o,i):x(o,i-1),n.push(a),o.children&&o.children.forEach(function(e){t(e,i+1)}))};return o(t.data,1),n.join("\n")},j=function(t){return $(t,"md")},N=function(t){return $(t,"txt")},y=function(t){return t.data},S={jm:w,km:k,md:j,txt:N,mm:y},T=function(t,e){return S[e](t)},M=function(t,e,n){var o=document.createElement("a");o.download=e+"."+n;var i=new Blob([t]);o.href=URL.createObjectURL(i),o.click(),log(o)},O=(n("7f7f"),n("28a5"),n("9ba9"),{jm:!0,txt:!0,md:!0,mm:!0,km:!0}),B=function(t){return new Promise(function(e,n){var o=new FileReader;o.onload=function(t){var n=t.target.result;e(n)},o.readAsText(t,"utf-8")})},E=function(){return new Promise(function(t,e){var n=document.createElement("input");n.type="file",n.accept=".jm,.txt,.md,.km,.mm",n.addEventListener("change",function(e){var n=e.target.files[0],o=n.name.split("."),i=(o[0],o[1].toLocaleLowerCase());O[i]?B(n).then(function(e){t({data:e,format:i})}):alert("暂不支持此类文件")}),n.click(),n.remove()})},L=(n("a481"),n("4917"),n("6b54"),function(){return((new Date).getTime().toString(16)+Math.random().toString(16).substr(2)).substr(2,16)}),P=function(t){return JSON.parse(t)},F=function(t,e){var n,o;if("md"===e){var i=t.match(/^#{1,6} /);null!==i?(n=i[0].length-2,o=t.split(" ")[1]):(i=t.match(/^\s*\S /),n=i[0].length+3,o=t.split(" ")[1])}else"txt"===e&&(n=t.match(/^\s*/)[0].length,o=t.replace(/^\s*/,""));return{layer:n,text:o}},J=function t(e,n,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(-1!==o||0!==e.length){if(-1===o){var a=F(e.shift(),n);o=a.layer||0,i=a.text||"未知数据"}var s={id:0===o?"root":L(),topic:i,expanded:!0,children:[]};while(e.length>0){var c=F(e[0],n),r=c.layer,l=c.text;if(!(r>o))break;e.shift();var d=t(e,n,r,l);s.children.push(d)}return s}},A=function(t,e){var n=t.split("\n"),o=J(n,e,-1),i={meta:{name:"Vmind",author:"sdk233@outlook.com",version:"0.1"},format:"node_tree",data:{}};return i.data=o,i},V=function t(e){var n={};return n.id=e.id,n.topic=e.text,n.id=e.id,n.expanded="expand"===e.expandState,e.children&&(n.children=e.children.map(function(e){return t(e.data)})),n},D=function(t){var e=JSON.parse(t),n=V(e.root.data);return{meta:{name:"Vmind",author:"sdk233@outlook.com",version:"0.1"},format:"node_tree",data:n}},W=function(t){return{meta:{name:"Vmind",author:"sdk233@outlook.com",version:"0.1"},format:"freemind",data:t}},I={jm:P,km:D,md:A,txt:A,mm:W},R=function(t,e){return I[e](t,e)},U={container:"jsmind_container",editable:!0,theme:"warning",mode:"full",view:{hmargin:100,vmargin:100,line_width:2,line_color:"#555"},layout:{hspace:50,vspace:40,pspace:13},shortcut:{enable:!0,handles:{},mapping:{addchild:9,addbrother:13,editnode:113,delnode:46,toggle:32,left:37,up:38,right:39,down:40}}},q={meta:{name:"Vmind",author:"sdk233@outlook.com",version:"0.1"},format:"node_tree",data:{id:"root",topic:"主题",expanded:!0,children:[{id:"1",topic:"分支1",expanded:!0,direction:"right"},{id:"2",topic:"分支2",expanded:!0,direction:"right"},{id:"3",topic:"分支3",expanded:!0,direction:"right"}]}},G={components:{popup:g},methods:{init:function(){var t=this;this.jm=new d.a(U);var e=b.getLocal();e?this.jm.show(e):this.jm.show(q);var n=this.jm;this.jm.add_event_listener(function(e,o){3===e&&(b.saveLocal(n.get_data()),t.$bus.$emit("popup-hide"))})},download:function(t,e){var n;"img"!==t?(n="mm"===t?this.jm.get_data("freemind"):this.jm.get_data(),n=T(n,t),M(n,e,t)):this.jm.screenshot.shootDownload()},popupBindEevent:function(){var t=this;this.$bus.$on("addNode",function(){var e=t.jm.get_selected_node();if(e){var n=d.a.util.uuid.newid(),o="新建节点",i=t.jm.add_node(e,n,o);t.$bus.$emit("editNode",i)}}),this.$bus.$on("addBrotherNode",function(){var e=t.jm.get_selected_node();if(!e.isroot&&e){var n=d.a.util.uuid.newid(),o="新建节点";t.jm.insert_node_after(e,n,o),t.$bus.$emit("editNode",n)}}),this.$bus.$on("deleteNode",function(){var e=t.jm.get_selected_node();e.isroot||e&&t.jm.remove_node(e)}),this.$bus.$on("editNode",function(e){if(e)t.jm.begin_edit(e);else{var n=t.jm.get_selected_node();n&&t.jm.begin_edit(n)}setTimeout(function(){document.querySelector(".jsmind-editor").focus()},20)}),this.$bus.$on("toggleNode",function(){var e=t.jm.get_selected_node();e&&t.jm.toggle_node(e)})}},created:function(){var t=this;this.$bus.$on("download",function(e,n){t.download(e,n)}),this.$bus.$on("createNewMind",function(){t.jm.show(q),b.clearLocal()}),this.$bus.$on("openFile",function(){E().then(function(e){var n=e.data,o=e.format,i=R(n,o);t.jm.show(i)})}),this.popupBindEevent(),this.$bus.$on("selectTheme",function(e){t.jm.set_theme(e)}),this.$bus.$on("unfoldAllNodes",function(e){e?t.jm.expand_all():t.jm.collapse_all()}),window.addEventListener("keydown",function(e){if(13===e.keyCode||9===e.keyCode){var n=t.jm.get_selected_node();null!==n&&t.$bus.$emit("editNode",n)}})},mounted:function(){this.init()}},K=G,X=Object(p["a"])(K,c,r,!1,null,null,null),z=X.exports,H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"nav-bar-wrapper"},[n("file-action-menu",{attrs:{title:t.title}}),n("div",{staticClass:"file-title-wrapper"},[n("span",{staticClass:"file-title",on:{click:function(e){t.changeTitle=!0}}},[n("span",{directives:[{name:"show",rawName:"v-show",value:!t.changeTitle,expression:"!changeTitle"}],ref:"fileTitle"},[t._v("\r\n                "+t._s(t.title)+"\r\n            ")]),t.changeTitle?n("input",{directives:[{name:"focus",rawName:"v-focus"},{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"input-title",style:{width:t.inputWidth},attrs:{type:"text",placeholder:"输入新标题"},domProps:{value:t.title},on:{keydown:function(e){if(!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter"))return null;t.changeTitle=!1},blur:function(e){t.changeTitle=!1},input:function(e){e.target.composing||(t.title=e.target.value)}}}):t._e()])]),n("view-control")],1)},Q=[],Y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"file-action"},[n("button",{staticClass:"create",on:{click:function(e){t.showMessageBox=1}}},[n("span",{staticClass:"icon icon-create"}),n("span",[t._v("新建")])]),n("button",{staticClass:"open",on:{click:function(e){t.showMessageBox=2}}},[n("span",{staticClass:"icon icon-open"}),n("span",[t._v("打开")])]),n("button",{staticClass:"download",on:{click:function(e){t.showMessageBox=3}}},[n("span",{staticClass:"icon icon-download"}),n("span",[t._v("导出")])]),0!==t.showMessageBox?n("message-box",{on:{cancel:function(e){t.showMessageBox=0},confirm:function(e){return t.clickConfirm()}}},[1===t.showMessageBox?n("p",[t._v("此操作将导致当前思维导图的数据丢失!")]):2===t.showMessageBox?n("p",[t._v("此操作将导致当前思维导图的数据丢失!")]):3===t.showMessageBox?n("div",{staticClass:"radio-group"},[n("p",{staticStyle:{padding:"0"}},[t._v("选择下载格式")]),n("label",{staticClass:"radio",on:{click:function(e){return t.toggleCheck(1)}}},[n("span",{staticClass:"radio-inner",class:{"radio-checked":1===t.checked}}),n("span",{staticClass:"radio-label"},[t._v("PNG (.png)")])]),n("label",{staticClass:"radio",on:{click:function(e){return t.toggleCheck(2)}}},[n("span",{staticClass:"radio-inner",class:{"radio-checked":2===t.checked}}),n("span",{staticClass:"radio-label"},[t._v("JMind (.jm)")])]),n("label",{staticClass:"radio",on:{click:function(e){return t.toggleCheck(3)}}},[n("span",{staticClass:"radio-inner",class:{"radio-checked":3===t.checked}}),n("span",{staticClass:"radio-label"},[t._v("MarkDown (.md)")])]),n("label",{staticClass:"radio",on:{click:function(e){return t.toggleCheck(4)}}},[n("span",{staticClass:"radio-inner",class:{"radio-checked":4===t.checked}}),n("span",{staticClass:"radio-label"},[t._v("大纲文本 (.txt)")])]),n("label",{staticClass:"radio",on:{click:function(e){return t.toggleCheck(5)}}},[n("span",{staticClass:"radio-inner",class:{"radio-checked":5===t.checked}}),n("span",{staticClass:"radio-label"},[t._v("KityMinder (百度脑图)")])]),n("label",{staticClass:"radio",on:{click:function(e){return t.toggleCheck(6)}}},[n("span",{staticClass:"radio-inner",class:{"radio-checked":6===t.checked}}),n("span",{staticClass:"radio-label"},[t._v("Freemind (XMind)")])])]):t._e()]):t._e()],1)},Z=[],tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"message-box-wrapper fadein"},[n("div",{staticClass:"mask"}),n("section",{staticClass:"message-box"},[t._m(0),n("div",{staticClass:"message-box-content"},[t._t("default")],2),n("div",{staticClass:"message-box-control"},[n("button",{staticClass:"message-box-cancel btn btn-small",on:{click:function(e){return t.cancel()}}},[t._v("取消")]),n("button",{staticClass:"message-box-confirm btn btn-small btn-primary",on:{click:function(e){return t.confirm()}}},[t._v("确定")])])])])},et=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"message-box-header"},[n("div",{staticClass:"message-box-title"},[t._v("提示")])])}],nt={methods:{cancel:function(){this.$emit("cancel")},confirm:function(){this.$emit("confirm")}}},ot=nt,it=(n("43b7"),Object(p["a"])(ot,tt,et,!1,null,"2892e6bf",null)),at=it.exports,st={props:["title"],components:{messageBox:at},data:function(){return{showMessageBox:0,checked:0,downFormat:{1:"img",2:"jm",3:"md",4:"txt",5:"km",6:"mm"}}},methods:{toggleCheck:function(t){this.checked=t},download:function(){var t=this.downFormat[this.checked];this.$bus.$emit("download",t,this.title)},openFile:function(){this.$bus.$emit("openFile")},createNewMind:function(){this.$bus.$emit("createNewMind")},clickConfirm:function(){var t={1:this.createNewMind,2:this.openFile,3:this.download};t[this.showMessageBox](),this.showMessageBox=0}}},ct=st,rt=(n("9ae0"),Object(p["a"])(ct,Y,Z,!1,null,"2f392a14",null)),lt=rt.exports,dt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"view-control"},[n("button",{staticClass:"theme",on:{mouseover:function(e){t.showSelecter=!0},mouseout:function(e){t.showSelecter=!1}}},[n("span",{staticClass:"icon icon-theme"}),n("span",[t._v("主题")]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.showSelecter,expression:"showSelecter"}],staticClass:"theme-control fadein"},[n("div",{staticClass:"theme-item",on:{click:function(e){return t.selectTheme(0)}}},[n("li",{staticStyle:{"background-color":"#409EFF"}})]),n("div",{staticClass:"theme-item",on:{click:function(e){return t.selectTheme(1)}}},[n("li",{staticStyle:{"background-color":"#67C23A"}})]),n("div",{staticClass:"theme-item",on:{click:function(e){return t.selectTheme(2)}}},[n("li",{staticStyle:{"background-color":"#E6A23C"}})]),n("div",{staticClass:"theme-item",on:{click:function(e){return t.selectTheme(3)}}},[n("li",{staticStyle:{"background-color":"#909399"}})]),n("div",{staticClass:"theme-item",on:{click:function(e){return t.selectTheme(4)}}},[n("li",{staticStyle:{"background-color":"#F56C6C"}})])])]),n("button",{staticClass:"unfold-all-nodes",on:{click:function(e){return t.unfoldAllNodes()}}},[n("span",{staticClass:"icon icon-unfold-all"}),t.unfold?n("span",[t._v("收起所有")]):n("span",[t._v("展开所有")])])])},ut=[],ft={data:function(){return{showSelecter:!1,themes:["primary","success","warning","info","danger"],unfold:!1}},methods:{selectTheme:function(t){var e=this.themes[t];this.$bus.$emit("selectTheme",e)},unfoldAllNodes:function(){this.unfold=!this.unfold,this.$bus.$emit("unfoldAllNodes",this.unfold)}}},mt=ft,ht=(n("856b"),Object(p["a"])(mt,dt,ut,!1,null,null,null)),pt=ht.exports,vt={components:{fileActionMenu:lt,viewControl:pt},data:function(){return{title:"未命名标题",changeTitle:!1,inputWidth:"150px"}},updated:function(){var t=this.$refs.fileTitle.offsetWidth;t&&(this.inputWidth=t+"px")},directives:{focus:{inserted:function(t){t.focus()}}}},gt=vt,bt=(n("7d17"),Object(p["a"])(gt,H,Q,!1,null,"48d2f4ef",null)),wt=bt.exports,_t={name:"app",components:{mindMap:z,navBar:wt}},kt=_t,Ct=Object(p["a"])(kt,a,s,!1,null,null,null),xt=Ct.exports,$t=new i.a;i.a.prototype.$bus=$t,i.a.config.productionTip=!1,new i.a({render:function(t){return t(xt)}}).$mount("#app")},7899:function(t,e,n){"use strict";var o=n("c974"),i=n.n(o);i.a},"7d17":function(t,e,n){"use strict";var o=n("db2c"),i=n.n(o);i.a},"856b":function(t,e,n){"use strict";var o=n("5290"),i=n.n(o);i.a},"8bbf":function(t,e){t.exports=Vue},"9ae0":function(t,e,n){"use strict";var o=n("507a"),i=n.n(o);i.a},c974:function(t,e,n){},db2c:function(t,e,n){}});
//# sourceMappingURL=app-legacy.68165fec.js.map